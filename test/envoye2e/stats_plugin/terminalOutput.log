=== RUN   TestAttributeGen
2020/07/07 23:16:50 XDS server starting on 20545
2020/07/07 23:16:50 update config for "client" with version "0"

name: client
traffic_direction: OUTBOUND
address:
  socket_address:
    address: 127.0.0.1
    port_value: 20542
filter_chains:
- filters:
  - name: http
    typed_config:
      "@type": type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager
      codec_type: AUTO
      stat_prefix: client
      http_filters:
      - name: envoy.filters.http.wasm
        typed_config:
          "@type": type.googleapis.com/udpa.type.v1.TypedStruct
          type_url: envoy.extensions.filters.http.wasm.v3.Wasm
          value:
            config:
              vm_config:
                runtime: envoy.wasm.runtime.null
                code:
                  local: { inline_string: "envoy.wasm.metadata_exchange" }
              configuration:
                "@type": "type.googleapis.com/google.protobuf.StringValue"
                value: |
                  { "max_peer_cache_size": 20 }
      - name: envoy.filters.http.wasm
        typed_config:
          "@type": type.googleapis.com/udpa.type.v1.TypedStruct
          type_url: envoy.extensions.filters.http.wasm.v3.Wasm
          value:
            config:
              root_id: "stats_outbound"
              vm_config:
                vm_id: stats_outbound0
                runtime: envoy.wasm.runtime.null
                code:
                  local: { inline_string: "envoy.wasm.stats" }
              configuration:
                "@type": "type.googleapis.com/google.protobuf.StringValue"
                value: |
                  {"debug":"false","field_separator":";.;","max_peer_cache_size":20,"metrics":[{"dimensions":{"configurable_metric_a":"(request.host.startsWith('127.0.0.1') ? 'localhost:' : request.host) + string(upstream_peer_id)","configurable_metric_b":"request.protocol"}}]}
      
      
      - name: envoy.router
      route_config:
        name: client
        virtual_hosts:
        - name: client
          domains: ["*"]
          routes:
          - match: { prefix: / }
            route:
              cluster: outbound|9080|http|server.default.svc.cluster.local
              timeout: 0s

2020/07/07 23:16:50 update config for "server" with version "0"

name: server
traffic_direction: INBOUND
address:
  socket_address:
    address: 127.0.0.1
    port_value: 20543
filter_chains:
- filters:
  - name: http
    typed_config:
      "@type": type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager
      codec_type: AUTO
      stat_prefix: server
      http_filters:
      - name: envoy.filters.http.wasm
        typed_config:
          "@type": type.googleapis.com/udpa.type.v1.TypedStruct
          type_url: envoy.extensions.filters.http.wasm.v3.Wasm
          value:
            config:
              vm_config:
                runtime: envoy.wasm.runtime.null
                code:
                  local: { inline_string: "envoy.wasm.metadata_exchange" }
              configuration:
                "@type": "type.googleapis.com/google.protobuf.StringValue"
                value: |
                  { "max_peer_cache_size": 20 }
      - name: envoy.filters.http.wasm
        typed_config:
          "@type": type.googleapis.com/udpa.type.v1.TypedStruct
          type_url: envoy.extensions.filters.http.wasm.v3.Wasm
          value:
            config:
              root_id: "stats_inbound"
              vm_config:
                vm_id: stats_inbound0
                runtime: envoy.wasm.runtime.null
                code:
                  local: { inline_string: "envoy.wasm.stats" }
              configuration:
                "@type": "type.googleapis.com/google.protobuf.StringValue"
                value: |
                  {"debug":"true","field_separator":";.;","max_peer_cache_size":20,"metrics":[{"dimensions":{"response_code":"istio_responseClass"},"name":"requests_total"}],"stat_prefix":"istio","value_separator":"=="}
      - name: istio.attributegen
        typed_config:
          "@type": type.googleapis.com/udpa.type.v1.TypedStruct
          type_url: type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm
          value:
            config:
              vm_config:
                vm_id: attributegen0
                runtime: envoy.wasm.runtime.null
                code:
                  local: { inline_string: "envoy.wasm.attributegen" }
              configuration:
                "@type": "type.googleapis.com/google.protobuf.StringValue"
                value: |
                  {
                    "attributes": [
                      {
                        "output_attribute": "istio_responseClass",
                        "match": [
                          {
                            "value": "2xx",
                            "condition": "response.code >= 200 && response.code <= 299"
                          }
                        ]
                      }
                    ]
                  }
      - name: envoy.router
      route_config:
        name: server
        virtual_hosts:
        - name: server
          domains: ["*"]
          routes:
          - match: { prefix: / }
            route:
              cluster: inbound|9080|http|server.default.svc.cluster.local
              timeout: 0s
  

2020/07/07 23:16:50 envoy bootstrap:
node:
  id: server
  cluster: test-cluster
  metadata: { "APP_CONTAINERS": ["server"],
"CONFIG_NAMESPACE": "default",
"EXCHANGE_KEYS": "NAME,NAMESPACE,INSTANCE_IPS,LABELS,OWNER,PLATFORM_METADATA,WORKLOAD_NAME,CANONICAL_TELEMETRY_SERVICE,MESH_ID,SERVICE_ACCOUNT",
"INCLUDE_INBOUND_PORTS": "9080",
"INSTANCE_IPS": "10.52.0.34,fe80::a075:11ff:fe5e:f1cd",
"INTERCEPTION_MODE": "REDIRECT",
"ISTIO_PROXY_SHA": "istio-proxy:47e4559b8e4f0d516c0d17b233d127a3deb3d7ce",
"ISTIO_VERSION": "1.5-dev",
"LABELS": {
    "app": "ratings",
    "pod-template-hash": "84975bc778",
    "version": "v1",
    "service.istio.io/canonical-name": "ratings",
    "service.istio.io/canonical-revision": "version-1"
},
"MESH_ID": "mesh",
"NAME": "ratings-v1-84975bc778-pxz2w",
"NAMESPACE": "default",
"OWNER": "kubernetes://apis/apps/v1/namespaces/default/deployments/ratings-v1",
"PLATFORM_METADATA": {
    "gcp_gke_cluster_name": "test-cluster",
    "gcp_location": "us-east4-b",
    "gcp_project": "test-project"
},
"POD_NAME": "ratings-v1-84975bc778-pxz2w",
"SERVICE_ACCOUNT": "bookinfo-ratings",
"SECURE_STACKDRIVER_ENDPOINT": "localhost:",
"STACKDRIVER_ROOT_CA_FILE": "",
"STACKDRIVER_TOKEN_FILE": "",
"STS_PORT": "",
"STACKDRIVER_MONITORING_EXPORT_INTERVAL_SECS": "20",
"STACKDRIVER_LOGGING_EXPORT_INTERVAL_SECS": "20",
"WORKLOAD_NAME": "ratings-v1",
"app": "ratings",
"istio": "sidecar",
"kubernetes.io/limit-ranger": "LimitRanger plugin set: cpu request for container ratings",
"pod-template-hash": "84975bc778",
"version": "v1"
 }
admin:
  access_log_path: /dev/null
  address:
    socket_address:
      address: 127.0.0.1
      port_value: 20544
stats_config:
  use_all_default_tags: true
  stats_tags:
  - tag_name: "reporter"
    regex: "(reporter=\\.=(.*?);\\.;)"
  - tag_name: "source_namespace"
    regex: "(source_namespace=\\.=(.*?);\\.;)"
  - tag_name: "source_workload"
    regex: "(source_workload=\\.=(.*?);\\.;)"
  - tag_name: "source_canonical_service"
    regex: "(source_canonical_service=\\.=(.*?);\\.;)"
  - tag_name: "source_canonical_revision"
    regex: "(source_canonical_revision=\\.=(.*?);\\.;)"
  - tag_name: "source_workload_namespace"
    regex: "(source_workload_namespace=\\.=(.*?);\\.;)"
  - tag_name: "source_principal"
    regex: "(source_principal=\\.=(.*?);\\.;)"
  - tag_name: "source_app"
    regex: "(source_app=\\.=(.*?);\\.;)"
  - tag_name: "source_version"
    regex: "(source_version=\\.=(.*?);\\.;)"
  - tag_name: "destination_namespace"
    regex: "(destination_namespace=\\.=(.*?);\\.;)"
  - tag_name: "destination_workload"
    regex: "(destination_workload=\\.=(.*?);\\.;)"
  - tag_name: "destination_workload_namespace"
    regex: "(destination_workload_namespace=\\.=(.*?);\\.;)"
  - tag_name: "destination_principal"
    regex: "(destination_principal=\\.=(.*?);\\.;)"
  - tag_name: "destination_app"
    regex: "(destination_app=\\.=(.*?);\\.;)"
  - tag_name: "destination_version"
    regex: "(destination_version=\\.=(.*?);\\.;)"
  - tag_name: "destination_service"
    regex: "(destination_service=\\.=(.*?);\\.;)"
  - tag_name: "destination_canonical_service"
    regex: "(destination_canonical_service=\\.=(.*?);\\.;)"
  - tag_name: "destination_canonical_revision"
    regex: "(destination_canonical_revision=\\.=(.*?);\\.;)"
  - tag_name: "destination_service_name"
    regex: "(destination_service_name=\\.=(.*?);\\.;)"
  - tag_name: "destination_service_namespace"
    regex: "(destination_service_namespace=\\.=(.*?);\\.;)"
  - tag_name: "request_protocol"
    regex: "(request_protocol=\\.=(.*?);\\.;)"
  - tag_name: "response_code"
    regex: "(response_code=\\.=(.*?);\\.;)|_rq(_(\\.d{3}))$"
  - tag_name: "grpc_response_status"
    regex: "(grpc_response_status=\\.=(.*?);\\.;)"
  - tag_name: "response_flags"
    regex: "(response_flags=\\.=(.*?);\\.;)"
  - tag_name: "connection_security_policy"
    regex: "(connection_security_policy=\\.=(.*?);\\.;)"
# Extra regexes used for configurable metrics
  - tag_name: "configurable_metric_a"
    regex: "(configurable_metric_a=\\.=(.*?);\\.;)"
  - tag_name: "configurable_metric_b"
    regex: "(configurable_metric_b=\\.=(.*?);\\.;)"
# Internal monitoring
  - tag_name: "cache"
    regex: "(cache\\.(.*?)\\.)"
  - tag_name: "component"
    regex: "(component\\.(.*?)\\.)"
  - tag_name: "tag"
    regex: "(tag\\.(.*?);\\.)"
  - tag_name: "wasm_filter"
    regex: "(wasm_filter\\.(.*?)\\.)"

dynamic_resources:
  ads_config:
    api_type: GRPC
    transport_api_version: V3
    grpc_services:
    - envoy_grpc:
        cluster_name: xds_cluster
  cds_config:
    ads: {}
    resource_api_version: V3
  lds_config:
    ads: {}
    resource_api_version: V3
static_resources:
  clusters:
  - connect_timeout: 1s
    load_assignment:
      cluster_name: xds_cluster
      endpoints:
      - lb_endpoints:
        - endpoint:
            address:
              socket_address:
                address: 127.0.0.1
                port_value: 20545
    http2_protocol_options: {}
    name: xds_cluster
  - name: inbound|9080|http|server.default.svc.cluster.local
    connect_timeout: 1s
    type: STATIC
    load_assignment:
      cluster_name: inbound|9080|http|server.default.svc.cluster.local
      endpoints:
      - lb_endpoints:
        - endpoint:
            address:
              socket_address:
                address: 127.0.0.1
                port_value: 20540
  
  listeners:
  - name: staticreply
    address:
      socket_address:
        address: 127.0.0.1
        port_value: 20540
    filter_chains:
    - filters:
      - name: http
        typed_config:
          "@type": type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager
          stat_prefix: staticreply
          codec_type: AUTO
          route_config:
            name: staticreply
            virtual_hosts:
            - name: staticreply
              domains: ["*"]
              routes:
              - match:
                  prefix: "/"
                direct_response:
                  status: 200
                  body:
                    inline_string: "hello, world!"
          http_filters:
          - name: envoy.filters.http.router

2020/07/07 23:16:50 admin port 20544
2020/07/07 23:16:50 envoy cmd [/usr/local/google/home/vicenteferrara/proxy/bazel-bin/src/envoy/envoy -c /tmp/envoy-bootstrap-270648154.yaml -l info --concurrency 1 --disable-hot-restart --drain-time-s 4]
2020/07/07 23:16:50 Pinging URL:  http://127.0.0.1:20544/ready
2020/07/07 23:16:50 HTTP GET http://127.0.0.1:20544/ready
2020/07/07 23:16:50 Get "http://127.0.0.1:20544/ready": dial tcp 127.0.0.1:20544: connect: connection refused
2020/07/07 23:16:50 Will wait 200ms and try again.
2020/07/07 23:16:50 Pinging URL:  http://127.0.0.1:20544/ready
2020/07/07 23:16:50 HTTP GET http://127.0.0.1:20544/ready
2020/07/07 23:16:50 Get "http://127.0.0.1:20544/ready": dial tcp 127.0.0.1:20544: connect: connection refused
2020/07/07 23:16:50 Will wait 200ms and try again.
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:257] initializing epoch 0 (hot restart version=disabled)
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:259] statically linked extensions:
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.access_loggers: envoy.access_loggers.file, envoy.access_loggers.http_grpc, envoy.access_loggers.tcp_grpc, envoy.access_loggers.wasm, envoy.file_access_log, envoy.http_grpc_access_log, envoy.tcp_grpc_access_log, envoy.wasm_access_log
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   http_cache_factory: envoy.extensions.http.cache.simple
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.tracers: envoy.dynamic.ot, envoy.lightstep, envoy.tracers.datadog, envoy.tracers.dynamic_ot, envoy.tracers.lightstep, envoy.tracers.opencensus, envoy.tracers.xray, envoy.tracers.zipkin, envoy.zipkin
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.dubbo_proxy.protocols: dubbo
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.network: envoy.client_ssl_auth, envoy.echo, envoy.ext_authz, envoy.filters.network.client_ssl_auth, envoy.filters.network.direct_response, envoy.filters.network.dubbo_proxy, envoy.filters.network.echo, envoy.filters.network.ext_authz, envoy.filters.network.http_connection_manager, envoy.filters.network.kafka_broker, envoy.filters.network.local_ratelimit, envoy.filters.network.metadata_exchange, envoy.filters.network.mongo_proxy, envoy.filters.network.mysql_proxy, envoy.filters.network.ratelimit, envoy.filters.network.rbac, envoy.filters.network.redis_proxy, envoy.filters.network.sni_cluster, envoy.filters.network.sni_dynamic_forward_proxy, envoy.filters.network.tcp_cluster_rewrite, envoy.filters.network.tcp_proxy, envoy.filters.network.thrift_proxy, envoy.filters.network.wasm, envoy.filters.network.zookeeper_proxy, envoy.http_connection_manager, envoy.mongo_proxy, envoy.ratelimit, envoy.redis_proxy, envoy.tcp_proxy, forward_downstream_sni, mixer, sni_verifier
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.thrift_proxy.filters: envoy.filters.thrift.rate_limit, envoy.filters.thrift.router
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.udp_listeners: raw_udp_listener
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.resolvers: envoy.ip
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.thrift_proxy.protocols: auto, binary, binary/non-strict, compact, twitter
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.thrift_proxy.transports: auto, framed, header, unframed
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.health_checkers: envoy.health_checkers.redis
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.retry_host_predicates: envoy.retry_host_predicates.omit_canary_hosts, envoy.retry_host_predicates.omit_host_metadata, envoy.retry_host_predicates.previous_hosts
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.resource_monitors: envoy.resource_monitors.fixed_heap, envoy.resource_monitors.injected_resource
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.http: envoy.buffer, envoy.cors, envoy.csrf, envoy.ext_authz, envoy.fault, envoy.filters.http.adaptive_concurrency, envoy.filters.http.aws_lambda, envoy.filters.http.aws_request_signing, envoy.filters.http.buffer, envoy.filters.http.cache, envoy.filters.http.cors, envoy.filters.http.csrf, envoy.filters.http.dynamic_forward_proxy, envoy.filters.http.dynamo, envoy.filters.http.ext_authz, envoy.filters.http.fault, envoy.filters.http.grpc_http1_bridge, envoy.filters.http.grpc_http1_reverse_bridge, envoy.filters.http.grpc_json_transcoder, envoy.filters.http.grpc_stats, envoy.filters.http.grpc_web, envoy.filters.http.gzip, envoy.filters.http.header_to_metadata, envoy.filters.http.health_check, envoy.filters.http.ip_tagging, envoy.filters.http.jwt_authn, envoy.filters.http.lua, envoy.filters.http.on_demand, envoy.filters.http.original_src, envoy.filters.http.ratelimit, envoy.filters.http.rbac, envoy.filters.http.router, envoy.filters.http.squash, envoy.filters.http.tap, envoy.filters.http.wasm, envoy.grpc_http1_bridge, envoy.grpc_json_transcoder, envoy.grpc_web, envoy.gzip, envoy.health_check, envoy.http_dynamo_filter, envoy.ip_tagging, envoy.lua, envoy.rate_limit, envoy.router, envoy.squash, istio.alpn, istio_authn, jwt-auth, mixer
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.listener: envoy.filters.listener.http_inspector, envoy.filters.listener.original_dst, envoy.filters.listener.original_src, envoy.filters.listener.proxy_protocol, envoy.filters.listener.tls_inspector, envoy.listener.http_inspector, envoy.listener.original_dst, envoy.listener.original_src, envoy.listener.proxy_protocol, envoy.listener.tls_inspector
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.udp_listener: envoy.filters.udp.dns_filter, envoy.filters.udp_listener.udp_proxy
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.clusters: envoy.cluster.eds, envoy.cluster.logical_dns, envoy.cluster.original_dst, envoy.cluster.static, envoy.cluster.strict_dns, envoy.clusters.aggregate, envoy.clusters.dynamic_forward_proxy, envoy.clusters.redis
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.upstream_network: envoy.filters.network.upstream.metadata_exchange
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.retry_priorities: envoy.retry_priorities.previous_priorities
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.dubbo_proxy.serializers: dubbo.hessian2
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.grpc_credentials: envoy.grpc_credentials.aws_iam, envoy.grpc_credentials.default, envoy.grpc_credentials.file_based_metadata
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   wasm_vm: envoy.wasm
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.transport_sockets.downstream: envoy.transport_sockets.alts, envoy.transport_sockets.raw_buffer, envoy.transport_sockets.tap, envoy.transport_sockets.tls, raw_buffer, tls
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.transport_sockets.upstream: envoy.transport_sockets.alts, envoy.transport_sockets.raw_buffer, envoy.transport_sockets.tap, envoy.transport_sockets.tls, raw_buffer, tls
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.dubbo_proxy.route_matchers: default
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.stats_sinks: envoy.dog_statsd, envoy.metrics_service, envoy.stat_sinks.dog_statsd, envoy.stat_sinks.hystrix, envoy.stat_sinks.metrics_service, envoy.stat_sinks.statsd, envoy.statsd
[2020-07-07 23:16:50.704][1893323][info][main] [external/envoy/source/server/server.cc:261]   envoy.dubbo_proxy.filters: envoy.filters.dubbo.router
2020/07/07 23:16:50 Pinging URL:  http://127.0.0.1:20544/ready
2020/07/07 23:16:50 HTTP GET http://127.0.0.1:20544/ready
2020/07/07 23:16:50 Get "http://127.0.0.1:20544/ready": dial tcp 127.0.0.1:20544: connect: connection refused
2020/07/07 23:16:50 Will wait 200ms and try again.
[2020-07-07 23:16:50.981][1893323][info][main] [external/envoy/source/server/server.cc:342] admin address: 127.0.0.1:20544
2020/07/07 23:16:50 Pinging URL:  http://127.0.0.1:20544/ready
2020/07/07 23:16:50 HTTP GET http://127.0.0.1:20544/ready
2020/07/07 23:16:50 Get "http://127.0.0.1:20544/ready": dial tcp 127.0.0.1:20544: connect: connection refused
2020/07/07 23:16:50 Will wait 200ms and try again.
[2020-07-07 23:16:51.084][1893323][info][main] [external/envoy/source/server/server.cc:481] runtime: layers:
  - name: base
    static_layer:
      {}
  - name: admin
    admin_layer:
      {}
[2020-07-07 23:16:51.102][1893323][info][config] [external/envoy/source/server/configuration_impl.cc:103] loading tracing configuration
[2020-07-07 23:16:51.102][1893323][info][config] [external/envoy/source/server/configuration_impl.cc:69] loading 0 static secret(s)
[2020-07-07 23:16:51.102][1893323][info][config] [external/envoy/source/server/configuration_impl.cc:75] loading 2 cluster(s)
2020/07/07 23:16:51 Pinging URL:  http://127.0.0.1:20544/ready
2020/07/07 23:16:51 HTTP GET http://127.0.0.1:20544/ready
[2020-07-07 23:16:52.338][1893323][info][upstream] [external/envoy/source/common/upstream/cluster_manager_impl.cc:167] cm init: initializing cds
[2020-07-07 23:16:52.400][1893323][info][config] [external/envoy/source/server/configuration_impl.cc:79] loading 1 listener(s)
[2020-07-07 23:16:52.746][1893323][info][config] [external/envoy/source/server/configuration_impl.cc:129] loading stats sink configuration
[2020-07-07 23:16:52.772][1893323][info][main] [external/envoy/source/server/server.cc:576] starting main dispatch loop
2020/07/07 23:16:52 xds debug: respond type.googleapis.com/envoy.config.cluster.v3.Cluster[] version "" with version "0"
2020/07/07 23:16:52 Will wait 200ms and try again.
[2020-07-07 23:16:52.825][1893323][info][upstream] [external/envoy/source/common/upstream/cds_api_impl.cc:77] cds: add 0 cluster(s), remove 2 cluster(s)
[2020-07-07 23:16:52.826][1893323][info][upstream] [external/envoy/source/common/upstream/cluster_manager_impl.cc:171] cm init: all clusters initialized
[2020-07-07 23:16:52.826][1893323][info][main] [external/envoy/source/server/server.cc:555] all clusters initialized. initializing init manager
2020/07/07 23:16:52 xds debug: respond type.googleapis.com/envoy.config.listener.v3.Listener[] version "" with version "0"
2020/07/07 23:16:52 xds debug: open watch 1 for type.googleapis.com/envoy.config.cluster.v3.Cluster[] from nodeID "server", version "0"
2020/07/07 23:16:53 Pinging URL:  http://127.0.0.1:20544/ready
2020/07/07 23:16:53 HTTP GET http://127.0.0.1:20544/ready
[2020-07-07 23:16:53.183][1893323][warning][misc] [bazel-out/k8-fastbuild/bin/external/envoy/source/extensions/common/_virtual_includes/utility_lib/extensions/common/utility.h:65] Using deprecated extension name 'envoy.router' for 'envoy.filters.http.router'. This name will be removed from Envoy soon. Please see https://www.envoyproxy.io/docs/envoy/latest/intro/deprecated for details.
[2020-07-07 23:16:53.208][1893323][info][upstream] [external/envoy/source/server/lds_api.cc:76] lds: add/update listener 'server'
[2020-07-07 23:16:53.208][1893323][info][config] [external/envoy/source/server/listener_manager_impl.cc:796] all dependencies initialized. starting workers
2020/07/07 23:16:53 xds debug: open watch 2 for type.googleapis.com/envoy.config.listener.v3.Listener[] from nodeID "server", version "0"
2020/07/07 23:16:53 Server is up and running...
2020/07/07 23:16:53 envoy bootstrap:
node:
  id: client
  cluster: test-cluster
  metadata: { "APP_CONTAINERS": ["test", "bonzai"],
"CONFIG_NAMESPACE": "default",
"EXCHANGE_KEYS": "NAME,NAMESPACE,INSTANCE_IPS,LABELS,OWNER,PLATFORM_METADATA,WORKLOAD_NAME,CANONICAL_TELEMETRY_SERVICE,MESH_ID,SERVICE_ACCOUNT",
"INCLUDE_INBOUND_PORTS": "9080",
"INSTANCE_IPS": "10.52.0.34,fe80::a075:11ff:fe5e:f1cd",
"INTERCEPTION_MODE": "REDIRECT",
"ISTIO_PROXY_SHA": "istio-proxy:47e4559b8e4f0d516c0d17b233d127a3deb3d7ce",
"ISTIO_VERSION": "1.5-dev",
"LABELS": {
    "app": "productpage",
    "pod-template-hash": "84975bc778",
    "version": "v1",
    "service.istio.io/canonical-name": "productpage-v1",
    "service.istio.io/canonical-revision": "version-1"
},
"MESH_ID": "mesh",
"NAME": "productpage-v1-84975bc778-pxz2w",
"NAMESPACE": "default",
"OWNER": "kubernetes://apis/apps/v1/namespaces/default/deployments/productpage-v1",
"PLATFORM_METADATA": {
    "gcp_gke_cluster_name": "test-cluster",
    "gcp_location": "us-east4-b",
    "gcp_project": "test-project"
},
"POD_NAME": "productpage-v1-84975bc778-pxz2w",
"SERVICE_ACCOUNT": "bookinfo-productpage",
"SECURE_STACKDRIVER_ENDPOINT": "localhost:",
"STACKDRIVER_ROOT_CA_FILE": "",
"STACKDRIVER_TOKEN_FILE": "",
"STACKDRIVER_MONITORING_EXPORT_INTERVAL_SECS": "20",
"STACKDRIVER_LOGGING_EXPORT_INTERVAL_SECS": "20",
"STS_PORT": "",
"WORKLOAD_NAME": "productpage-v1",
"app": "productpage",
"istio": "sidecar",
"kubernetes.io/limit-ranger": "LimitRanger plugin set: cpu request for container productpage",
"pod-template-hash": "84975bc778",
"version": "v1"
 }
admin:
  access_log_path: /dev/null
  address:
    socket_address:
      address: 127.0.0.1
      port_value: 20541
stats_config:
  use_all_default_tags: true
  stats_tags:
  - tag_name: "reporter"
    regex: "(reporter=\\.=(.*?);\\.;)"
  - tag_name: "source_namespace"
    regex: "(source_namespace=\\.=(.*?);\\.;)"
  - tag_name: "source_workload"
    regex: "(source_workload=\\.=(.*?);\\.;)"
  - tag_name: "source_canonical_service"
    regex: "(source_canonical_service=\\.=(.*?);\\.;)"
  - tag_name: "source_canonical_revision"
    regex: "(source_canonical_revision=\\.=(.*?);\\.;)"
  - tag_name: "source_workload_namespace"
    regex: "(source_workload_namespace=\\.=(.*?);\\.;)"
  - tag_name: "source_principal"
    regex: "(source_principal=\\.=(.*?);\\.;)"
  - tag_name: "source_app"
    regex: "(source_app=\\.=(.*?);\\.;)"
  - tag_name: "source_version"
    regex: "(source_version=\\.=(.*?);\\.;)"
  - tag_name: "destination_namespace"
    regex: "(destination_namespace=\\.=(.*?);\\.;)"
  - tag_name: "destination_workload"
    regex: "(destination_workload=\\.=(.*?);\\.;)"
  - tag_name: "destination_workload_namespace"
    regex: "(destination_workload_namespace=\\.=(.*?);\\.;)"
  - tag_name: "destination_principal"
    regex: "(destination_principal=\\.=(.*?);\\.;)"
  - tag_name: "destination_app"
    regex: "(destination_app=\\.=(.*?);\\.;)"
  - tag_name: "destination_version"
    regex: "(destination_version=\\.=(.*?);\\.;)"
  - tag_name: "destination_service"
    regex: "(destination_service=\\.=(.*?);\\.;)"
  - tag_name: "destination_canonical_service"
    regex: "(destination_canonical_service=\\.=(.*?);\\.;)"
  - tag_name: "destination_canonical_revision"
    regex: "(destination_canonical_revision=\\.=(.*?);\\.;)"
  - tag_name: "destination_service_name"
    regex: "(destination_service_name=\\.=(.*?);\\.;)"
  - tag_name: "destination_service_namespace"
    regex: "(destination_service_namespace=\\.=(.*?);\\.;)"
  - tag_name: "request_protocol"
    regex: "(request_protocol=\\.=(.*?);\\.;)"
  - tag_name: "response_code"
    regex: "(response_code=\\.=(.*?);\\.;)|_rq(_(\\.d{3}))$"
  - tag_name: "grpc_response_status"
    regex: "(grpc_response_status=\\.=(.*?);\\.;)"
  - tag_name: "response_flags"
    regex: "(response_flags=\\.=(.*?);\\.;)"
  - tag_name: "connection_security_policy"
    regex: "(connection_security_policy=\\.=(.*?);\\.;)"
# Extra regexes used for configurable metrics
  - tag_name: "configurable_metric_a"
    regex: "(configurable_metric_a=\\.=(.*?);\\.;)"
  - tag_name: "configurable_metric_b"
    regex: "(configurable_metric_b=\\.=(.*?);\\.;)"
# Internal monitoring
  - tag_name: "cache"
    regex: "(cache\\.(.*?)\\.)"
  - tag_name: "component"
    regex: "(component\\.(.*?)\\.)"
  - tag_name: "tag"
    regex: "(tag\\.(.*?);\\.)"
  - tag_name: "wasm_filter"
    regex: "(wasm_filter\\.(.*?)\\.)"

dynamic_resources:
  ads_config:
    api_type: GRPC
    transport_api_version: V3
    grpc_services:
    - envoy_grpc:
        cluster_name: xds_cluster
  cds_config:
    ads: {}
    resource_api_version: V3
  lds_config:
    ads: {}
    resource_api_version: V3
static_resources:
  clusters:
  - connect_timeout: 1s
    load_assignment:
      cluster_name: xds_cluster
      endpoints:
      - lb_endpoints:
        - endpoint:
            address:
              socket_address:
                address: 127.0.0.1
                port_value: 20545
    http2_protocol_options: {}
    name: xds_cluster
  - name: outbound|9080|http|server.default.svc.cluster.local
    connect_timeout: 1s
    type: STATIC
    http2_protocol_options: {}
    load_assignment:
      cluster_name: outbound|9080|http|server.default.svc.cluster.local
      endpoints:
      - lb_endpoints:
        - endpoint:
            address:
              socket_address:
                address: 127.0.0.1
                port_value: 20543
    
  

2020/07/07 23:16:53 admin port 20541
2020/07/07 23:16:53 envoy cmd [/usr/local/google/home/vicenteferrara/proxy/bazel-bin/src/envoy/envoy -c /tmp/envoy-bootstrap-886797553.yaml -l info --concurrency 1 --disable-hot-restart --drain-time-s 4]
2020/07/07 23:16:53 Pinging URL:  http://127.0.0.1:20541/ready
2020/07/07 23:16:53 HTTP GET http://127.0.0.1:20541/ready
2020/07/07 23:16:53 Get "http://127.0.0.1:20541/ready": dial tcp 127.0.0.1:20541: connect: connection refused
2020/07/07 23:16:53 Will wait 200ms and try again.
2020/07/07 23:16:53 Pinging URL:  http://127.0.0.1:20541/ready
2020/07/07 23:16:53 HTTP GET http://127.0.0.1:20541/ready
2020/07/07 23:16:53 Get "http://127.0.0.1:20541/ready": dial tcp 127.0.0.1:20541: connect: connection refused
2020/07/07 23:16:53 Will wait 200ms and try again.
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:257] initializing epoch 0 (hot restart version=disabled)
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:259] statically linked extensions:
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.http: envoy.buffer, envoy.cors, envoy.csrf, envoy.ext_authz, envoy.fault, envoy.filters.http.adaptive_concurrency, envoy.filters.http.aws_lambda, envoy.filters.http.aws_request_signing, envoy.filters.http.buffer, envoy.filters.http.cache, envoy.filters.http.cors, envoy.filters.http.csrf, envoy.filters.http.dynamic_forward_proxy, envoy.filters.http.dynamo, envoy.filters.http.ext_authz, envoy.filters.http.fault, envoy.filters.http.grpc_http1_bridge, envoy.filters.http.grpc_http1_reverse_bridge, envoy.filters.http.grpc_json_transcoder, envoy.filters.http.grpc_stats, envoy.filters.http.grpc_web, envoy.filters.http.gzip, envoy.filters.http.header_to_metadata, envoy.filters.http.health_check, envoy.filters.http.ip_tagging, envoy.filters.http.jwt_authn, envoy.filters.http.lua, envoy.filters.http.on_demand, envoy.filters.http.original_src, envoy.filters.http.ratelimit, envoy.filters.http.rbac, envoy.filters.http.router, envoy.filters.http.squash, envoy.filters.http.tap, envoy.filters.http.wasm, envoy.grpc_http1_bridge, envoy.grpc_json_transcoder, envoy.grpc_web, envoy.gzip, envoy.health_check, envoy.http_dynamo_filter, envoy.ip_tagging, envoy.lua, envoy.rate_limit, envoy.router, envoy.squash, istio.alpn, istio_authn, jwt-auth, mixer
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.resolvers: envoy.ip
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   wasm_vm: envoy.wasm
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.clusters: envoy.cluster.eds, envoy.cluster.logical_dns, envoy.cluster.original_dst, envoy.cluster.static, envoy.cluster.strict_dns, envoy.clusters.aggregate, envoy.clusters.dynamic_forward_proxy, envoy.clusters.redis
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.access_loggers: envoy.access_loggers.file, envoy.access_loggers.http_grpc, envoy.access_loggers.tcp_grpc, envoy.access_loggers.wasm, envoy.file_access_log, envoy.http_grpc_access_log, envoy.tcp_grpc_access_log, envoy.wasm_access_log
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.grpc_credentials: envoy.grpc_credentials.aws_iam, envoy.grpc_credentials.default, envoy.grpc_credentials.file_based_metadata
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.upstream_network: envoy.filters.network.upstream.metadata_exchange
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.thrift_proxy.transports: auto, framed, header, unframed
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.transport_sockets.upstream: envoy.transport_sockets.alts, envoy.transport_sockets.raw_buffer, envoy.transport_sockets.tap, envoy.transport_sockets.tls, raw_buffer, tls
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.dubbo_proxy.filters: envoy.filters.dubbo.router
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.udp_listeners: raw_udp_listener
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.dubbo_proxy.serializers: dubbo.hessian2
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.transport_sockets.downstream: envoy.transport_sockets.alts, envoy.transport_sockets.raw_buffer, envoy.transport_sockets.tap, envoy.transport_sockets.tls, raw_buffer, tls
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.tracers: envoy.dynamic.ot, envoy.lightstep, envoy.tracers.datadog, envoy.tracers.dynamic_ot, envoy.tracers.lightstep, envoy.tracers.opencensus, envoy.tracers.xray, envoy.tracers.zipkin, envoy.zipkin
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.stats_sinks: envoy.dog_statsd, envoy.metrics_service, envoy.stat_sinks.dog_statsd, envoy.stat_sinks.hystrix, envoy.stat_sinks.metrics_service, envoy.stat_sinks.statsd, envoy.statsd
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.retry_host_predicates: envoy.retry_host_predicates.omit_canary_hosts, envoy.retry_host_predicates.omit_host_metadata, envoy.retry_host_predicates.previous_hosts
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.dubbo_proxy.protocols: dubbo
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.retry_priorities: envoy.retry_priorities.previous_priorities
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   http_cache_factory: envoy.extensions.http.cache.simple
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.thrift_proxy.filters: envoy.filters.thrift.rate_limit, envoy.filters.thrift.router
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.dubbo_proxy.route_matchers: default
[2020-07-07 23:16:53.599][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.thrift_proxy.protocols: auto, binary, binary/non-strict, compact, twitter
[2020-07-07 23:16:53.600][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.health_checkers: envoy.health_checkers.redis
[2020-07-07 23:16:53.600][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.listener: envoy.filters.listener.http_inspector, envoy.filters.listener.original_dst, envoy.filters.listener.original_src, envoy.filters.listener.proxy_protocol, envoy.filters.listener.tls_inspector, envoy.listener.http_inspector, envoy.listener.original_dst, envoy.listener.original_src, envoy.listener.proxy_protocol, envoy.listener.tls_inspector
[2020-07-07 23:16:53.600][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.resource_monitors: envoy.resource_monitors.fixed_heap, envoy.resource_monitors.injected_resource
[2020-07-07 23:16:53.600][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.udp_listener: envoy.filters.udp.dns_filter, envoy.filters.udp_listener.udp_proxy
[2020-07-07 23:16:53.600][1893376][info][main] [external/envoy/source/server/server.cc:261]   envoy.filters.network: envoy.client_ssl_auth, envoy.echo, envoy.ext_authz, envoy.filters.network.client_ssl_auth, envoy.filters.network.direct_response, envoy.filters.network.dubbo_proxy, envoy.filters.network.echo, envoy.filters.network.ext_authz, envoy.filters.network.http_connection_manager, envoy.filters.network.kafka_broker, envoy.filters.network.local_ratelimit, envoy.filters.network.metadata_exchange, envoy.filters.network.mongo_proxy, envoy.filters.network.mysql_proxy, envoy.filters.network.ratelimit, envoy.filters.network.rbac, envoy.filters.network.redis_proxy, envoy.filters.network.sni_cluster, envoy.filters.network.sni_dynamic_forward_proxy, envoy.filters.network.tcp_cluster_rewrite, envoy.filters.network.tcp_proxy, envoy.filters.network.thrift_proxy, envoy.filters.network.wasm, envoy.filters.network.zookeeper_proxy, envoy.http_connection_manager, envoy.mongo_proxy, envoy.ratelimit, envoy.redis_proxy, envoy.tcp_proxy, forward_downstream_sni, mixer, sni_verifier
2020/07/07 23:16:53 Pinging URL:  http://127.0.0.1:20541/ready
2020/07/07 23:16:53 HTTP GET http://127.0.0.1:20541/ready
2020/07/07 23:16:53 Get "http://127.0.0.1:20541/ready": dial tcp 127.0.0.1:20541: connect: connection refused
2020/07/07 23:16:53 Will wait 200ms and try again.
2020/07/07 23:16:53 Pinging URL:  http://127.0.0.1:20541/ready
2020/07/07 23:16:53 HTTP GET http://127.0.0.1:20541/ready
[2020-07-07 23:16:53.869][1893376][info][main] [external/envoy/source/server/server.cc:342] admin address: 127.0.0.1:20541
2020/07/07 23:16:53 Get "http://127.0.0.1:20541/ready": dial tcp 127.0.0.1:20541: connect: connection refused
2020/07/07 23:16:53 Will wait 200ms and try again.
[2020-07-07 23:16:53.971][1893376][info][main] [external/envoy/source/server/server.cc:481] runtime: layers:
  - name: base
    static_layer:
      {}
  - name: admin
    admin_layer:
      {}
[2020-07-07 23:16:53.989][1893376][info][config] [external/envoy/source/server/configuration_impl.cc:103] loading tracing configuration
[2020-07-07 23:16:53.989][1893376][info][config] [external/envoy/source/server/configuration_impl.cc:69] loading 0 static secret(s)
[2020-07-07 23:16:53.989][1893376][info][config] [external/envoy/source/server/configuration_impl.cc:75] loading 2 cluster(s)
2020/07/07 23:16:54 Pinging URL:  http://127.0.0.1:20541/ready
2020/07/07 23:16:54 HTTP GET http://127.0.0.1:20541/ready
[2020-07-07 23:16:55.175][1893376][info][upstream] [external/envoy/source/common/upstream/cluster_manager_impl.cc:167] cm init: initializing cds
[2020-07-07 23:16:55.237][1893376][info][config] [external/envoy/source/server/configuration_impl.cc:79] loading 0 listener(s)
[2020-07-07 23:16:55.237][1893376][info][config] [external/envoy/source/server/configuration_impl.cc:129] loading stats sink configuration
[2020-07-07 23:16:55.263][1893376][info][main] [external/envoy/source/server/server.cc:576] starting main dispatch loop
2020/07/07 23:16:55 xds debug: respond type.googleapis.com/envoy.config.cluster.v3.Cluster[] version "" with version "0"
2020/07/07 23:16:55 Will wait 200ms and try again.
[2020-07-07 23:16:55.316][1893376][info][upstream] [external/envoy/source/common/upstream/cds_api_impl.cc:77] cds: add 0 cluster(s), remove 2 cluster(s)
[2020-07-07 23:16:55.317][1893376][info][upstream] [external/envoy/source/common/upstream/cluster_manager_impl.cc:171] cm init: all clusters initialized
[2020-07-07 23:16:55.317][1893376][info][main] [external/envoy/source/server/server.cc:555] all clusters initialized. initializing init manager
2020/07/07 23:16:55 xds debug: respond type.googleapis.com/envoy.config.listener.v3.Listener[] version "" with version "0"
2020/07/07 23:16:55 xds debug: open watch 3 for type.googleapis.com/envoy.config.cluster.v3.Cluster[] from nodeID "client", version "0"
2020/07/07 23:16:55 Pinging URL:  http://127.0.0.1:20541/ready
2020/07/07 23:16:55 HTTP GET http://127.0.0.1:20541/ready
[2020-07-07 23:16:55.669][1893376][warning][misc] [bazel-out/k8-fastbuild/bin/external/envoy/source/extensions/common/_virtual_includes/utility_lib/extensions/common/utility.h:65] Using deprecated extension name 'envoy.router' for 'envoy.filters.http.router'. This name will be removed from Envoy soon. Please see https://www.envoyproxy.io/docs/envoy/latest/intro/deprecated for details.
[2020-07-07 23:16:55.692][1893376][info][upstream] [external/envoy/source/server/lds_api.cc:76] lds: add/update listener 'client'
[2020-07-07 23:16:55.692][1893376][info][config] [external/envoy/source/server/listener_manager_impl.cc:796] all dependencies initialized. starting workers
2020/07/07 23:16:55 xds debug: open watch 4 for type.googleapis.com/envoy.config.listener.v3.Listener[] from nodeID "client", version "0"
2020/07/07 23:16:55 Server is up and running...
2020/07/07 23:16:55 sleeping 1s
2020/07/07 23:16:56 repeat 0 out of 10
2020/07/07 23:16:56 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 repeat 1 out of 10
2020/07/07 23:16:57 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 repeat 2 out of 10
2020/07/07 23:16:57 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 repeat 3 out of 10
2020/07/07 23:16:57 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 repeat 4 out of 10
2020/07/07 23:16:57 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 repeat 5 out of 10
2020/07/07 23:16:57 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 repeat 6 out of 10
2020/07/07 23:16:57 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 repeat 7 out of 10
2020/07/07 23:16:57 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 repeat 8 out of 10
2020/07/07 23:16:57 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 repeat 9 out of 10
2020/07/07 23:16:57 HTTP request:
GET / HTTP/1.1
Host: 127.0.0.1:20542

2020/07/07 23:16:57 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:16:57 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:16:58 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:16:58 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:16:59 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:16:59 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:00 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:00 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:01 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:02 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:03 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:03 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:04 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:04 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:05 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:05 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:06 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:06 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:07 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:07 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:08 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:08 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:09 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:09 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:10 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:10 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:11 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:11 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:12 HTTP GET http://127.0.0.1:20544/stats/prometheus
2020/07/07 23:17:13 failed to match all metrics: want map[string]driver.StatMatcher{"istio_requests_total":(*driver.ExactStat)(0xc0002c6280)}
2020/07/07 23:17:14 stop envoy ...
2020/07/07 23:17:14 HTTP POST http://127.0.0.1:20541/quitquitquit
[2020-07-07 23:17:14.125][1893376][info][main] [external/envoy/source/server/server.cc:635] shutting down server instance
[2020-07-07 23:17:14.125][1893376][info][main] [external/envoy/source/server/server.cc:687] Notifying 0 callback(s) with completion.
[2020-07-07 23:17:14.125][1893376][info][main] [external/envoy/source/server/server.cc:582] main dispatch loop exited
[2020-07-07 23:17:14.153][1893376][warning][config] [bazel-out/k8-fastbuild/bin/external/envoy/source/common/config/_virtual_includes/grpc_stream_lib/common/config/grpc_stream.h:92] StreamAggregatedResources gRPC config stream closed: 13, 
[2020-07-07 23:17:14.158][1893376][info][main] [external/envoy/source/server/server.cc:628] exiting
2020/07/07 23:17:14 stop envoy ... done
2020/07/07 23:17:14 removing temp config file
2020/07/07 23:17:14 stop envoy ...
2020/07/07 23:17:14 HTTP POST http://127.0.0.1:20544/quitquitquit
[2020-07-07 23:17:14.168][1893323][info][main] [external/envoy/source/server/server.cc:635] shutting down server instance
[2020-07-07 23:17:14.168][1893323][info][main] [external/envoy/source/server/server.cc:687] Notifying 0 callback(s) with completion.
[2020-07-07 23:17:14.169][1893323][info][main] [external/envoy/source/server/server.cc:582] main dispatch loop exited
[2020-07-07 23:17:14.196][1893323][warning][config] [bazel-out/k8-fastbuild/bin/external/envoy/source/common/config/_virtual_includes/grpc_stream_lib/common/config/grpc_stream.h:92] StreamAggregatedResources gRPC config stream closed: 13, 
[2020-07-07 23:17:14.202][1893323][info][main] [external/envoy/source/server/server.cc:628] exiting
2020/07/07 23:17:14 stop envoy ... done
2020/07/07 23:17:14 removing temp config file
2020/07/07 23:17:14 stopping XDS server
    TestAttributeGen: stats_test.go:331: failed to match all stats
--- FAIL: TestAttributeGen (24.31s)
FAIL
exit status 1
FAIL	istio.io/proxy/test/envoye2e/stats_plugin	24.527s
